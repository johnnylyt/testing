---
- name: Enable EPEL Repository on CentOS 8
  command: /usr/bin/dnf config-manager --set-enabled powertools

- name: Installing epel-release 
  yum: 
    name: 
      - epel-release
    state: latest

- name: Installing fusioninventory  
  yum: 
    name: 
      - fusioninventory-agent
      - fusioninventory-agent-task-inventory
    state: latest

    
- name: Enabling service 
  service: 
    name: fusioninventory-agent
    enabled: yes
    state: started

- name: Set crontab for daily task
  ansible.builtin.lineinfile:
    path: /var/spool/cron/root
    line: "0 2 * * * /usr/bin/fusioninventory-agent -f >/var/lib/fusioninventory-agent/cron.log 2>&1"
    state: present


